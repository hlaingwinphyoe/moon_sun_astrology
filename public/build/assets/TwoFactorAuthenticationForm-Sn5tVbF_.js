import{r as f,e as N,o as t,c as a,a as i,L as Q,Y as s,S as o,W as r,X as k,ac as B,M as g,n as Y,f as D,w as I,R as h,V as u,u as V,F as U,ab as W}from"./@vue-B1CVMTK9.js";import{Q as z,T as G,F as K}from"./@inertiajs-BgBGItYw.js";import{b as O,a as X}from"./DialogModal-DVZ-bMsS.js";import{_ as L}from"./InputError-Cdm0MI_H.js";import{_ as $}from"./PrimaryButton-D8YeF2wd.js";import{_ as C}from"./SecondaryButton-D1C-je09.js";import{_ as M}from"./TextInput-KsQ8oEBW.js";import{_ as j}from"./DangerButton-DHxd5rH1.js";import{_ as J}from"./InputLabel-Av1BZmNz.js";import"./axios-CCb-kr4I.js";import"./deepmerge-CtOfIP5S.js";import"./call-bind-aBC2DkHY.js";import"./get-intrinsic-BKEvijrG.js";import"./es-errors-DzOT6E3C.js";import"./has-symbols-eVqrYdw7.js";import"./has-proto-JnoBQRdH.js";import"./function-bind-BbkWVFrm.js";import"./hasown-DYqjtFKE.js";import"./set-function-length-B5OANX0j.js";import"./define-data-property-DO9o5wXF.js";import"./es-define-property-tzmkNPou.js";import"./gopd-CEkvUycD.js";import"./has-property-descriptors-DphFXkuo.js";import"./qs-Bgg5YRNC.js";import"./side-channel-CbjMffun.js";import"./object-inspect-8Tg_cmh0.js";import"./nprogress-uqLJ5xmn.js";import"./lodash.clonedeep-Bxvn-V0B.js";import"./lodash.isequal-BYpQg7Um.js";import"./SectionTitle-kJ-XoBXn.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"mt-4"},y={__name:"ConfirmsPassword",props:{title:{type:String,default:"Confirm Password"},content:{type:String,default:"For your security, please confirm your password to continue."},button:{type:String,default:"Confirm"}},emits:["confirmed"],setup(w,{emit:S}){const b=S,l=f(!1),e=N({password:"",error:"",processing:!1}),c=f(null),v=()=>{axios.get(route("password.confirmation")).then(n=>{n.data.confirmed?b("confirmed"):(l.value=!0,setTimeout(()=>c.value.focus(),250))})},_=()=>{e.processing=!0,axios.post(route("password.confirm"),{password:e.password}).then(()=>{e.processing=!1,d(),Y().then(()=>b("confirmed"))}).catch(n=>{e.processing=!1,e.error=n.response.data.errors.password[0],c.value.focus()})},d=()=>{l.value=!1,e.password="",e.error=""};return(n,m)=>(t(),a("span",null,[i("span",{onClick:v},[Q(n.$slots,"default")]),s(O,{show:l.value,onClose:d},{title:o(()=>[r(k(w.title),1)]),content:o(()=>[r(k(w.content)+" ",1),i("div",Z,[s(M,{ref_key:"passwordInput",ref:c,modelValue:e.password,"onUpdate:modelValue":m[0]||(m[0]=T=>e.password=T),type:"password",class:"mt-1 block w-3/4",placeholder:"Password",autocomplete:"current-password",onKeyup:B(_,["enter"])},null,8,["modelValue"]),s(L,{message:e.error,class:"mt-2"},null,8,["message"])])]),footer:o(()=>[s(C,{onClick:d},{default:o(()=>[r(" Cancel ")]),_:1}),s($,{class:g(["ms-3",{"opacity-25":e.processing}]),disabled:e.processing,onClick:_},{default:o(()=>[r(k(w.button),1)]),_:1},8,["class","disabled"])]),_:1},8,["show"])]))}},ee={key:0,class:"text-lg font-medium text-gray-900"},te={key:1,class:"text-lg font-medium text-gray-900"},oe={key:2,class:"text-lg font-medium text-gray-900"},ae=i("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[i("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),se={key:3},re={key:0},ne={class:"mt-4 max-w-xl text-sm text-gray-600"},ie={key:0,class:"font-semibold"},le={key:1},ce=["innerHTML"],ue={key:0,class:"mt-4 max-w-xl text-sm text-gray-600"},de={class:"font-semibold"},me=["innerHTML"],pe={key:1,class:"mt-4"},fe={key:1},_e=i("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[i("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),ve={class:"grid gap-1 max-w-xl mt-4 px-4 py-4 font-mono text-sm bg-gray-100 rounded-lg"},he={class:"mt-5"},ye={key:0},we={key:1},je={__name:"TwoFactorAuthenticationForm",props:{requiresConfirmation:Boolean},setup(w){const S=w,b=z(),l=f(!1),e=f(!1),c=f(!1),v=f(null),_=f(null),d=f([]),n=G({code:""}),m=D(()=>{var p;return!l.value&&((p=b.props.auth.user)==null?void 0:p.two_factor_enabled)});I(m,()=>{m.value||(n.reset(),n.clearErrors())});const T=()=>{l.value=!0,K.post(route("two-factor.enable"),{},{preserveScroll:!0,onSuccess:()=>Promise.all([q(),E(),F()]),onFinish:()=>{l.value=!1,e.value=S.requiresConfirmation}})},q=()=>axios.get(route("two-factor.qr-code")).then(p=>{v.value=p.data.svg}),E=()=>axios.get(route("two-factor.secret-key")).then(p=>{_.value=p.data.secretKey}),F=()=>axios.get(route("two-factor.recovery-codes")).then(p=>{d.value=p.data}),A=()=>{n.post(route("two-factor.confirm"),{errorBag:"confirmTwoFactorAuthentication",preserveScroll:!0,preserveState:!0,onSuccess:()=>{e.value=!1,v.value=null,_.value=null}})},H=()=>{axios.post(route("two-factor.recovery-codes")).then(()=>F())},P=()=>{c.value=!0,K.delete(route("two-factor.disable"),{preserveScroll:!0,onSuccess:()=>{c.value=!1,e.value=!1}})};return(p,R)=>(t(),h(X,null,{title:o(()=>[r(" Two Factor Authentication ")]),description:o(()=>[r(" Add additional security to your account using two factor authentication. ")]),content:o(()=>[m.value&&!e.value?(t(),a("h3",ee," You have enabled two factor authentication. ")):m.value&&e.value?(t(),a("h3",te," Finish enabling two factor authentication. ")):(t(),a("h3",oe," You have not enabled two factor authentication. ")),ae,m.value?(t(),a("div",se,[v.value?(t(),a("div",re,[i("div",ne,[e.value?(t(),a("p",ie," To finish enabling two factor authentication, scan the following QR code using your phone's authenticator application or enter the setup key and provide the generated OTP code. ")):(t(),a("p",le," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application or enter the setup key. "))]),i("div",{class:"mt-4 p-2 inline-block bg-white",innerHTML:v.value},null,8,ce),_.value?(t(),a("div",ue,[i("p",de,[r(" Setup Key: "),i("span",{innerHTML:_.value},null,8,me)])])):u("",!0),e.value?(t(),a("div",pe,[s(J,{for:"code",value:"Code"}),s(M,{id:"code",modelValue:V(n).code,"onUpdate:modelValue":R[0]||(R[0]=x=>V(n).code=x),type:"text",name:"code",class:"block mt-1 w-1/2",inputmode:"numeric",autofocus:"",autocomplete:"one-time-code",onKeyup:B(A,["enter"])},null,8,["modelValue"]),s(L,{message:V(n).errors.code,class:"mt-2"},null,8,["message"])])):u("",!0)])):u("",!0),d.value.length>0&&!e.value?(t(),a("div",fe,[_e,i("div",ve,[(t(!0),a(U,null,W(d.value,x=>(t(),a("div",{key:x},k(x),1))),128))])])):u("",!0)])):u("",!0),i("div",he,[m.value?(t(),a("div",we,[s(y,{onConfirmed:A},{default:o(()=>[e.value?(t(),h($,{key:0,type:"button",class:g(["me-3",{"opacity-25":l.value}]),disabled:l.value},{default:o(()=>[r(" Confirm ")]),_:1},8,["class","disabled"])):u("",!0)]),_:1}),s(y,{onConfirmed:H},{default:o(()=>[d.value.length>0&&!e.value?(t(),h(C,{key:0,class:"me-3"},{default:o(()=>[r(" Regenerate Recovery Codes ")]),_:1})):u("",!0)]),_:1}),s(y,{onConfirmed:F},{default:o(()=>[d.value.length===0&&!e.value?(t(),h(C,{key:0,class:"me-3"},{default:o(()=>[r(" Show Recovery Codes ")]),_:1})):u("",!0)]),_:1}),s(y,{onConfirmed:P},{default:o(()=>[e.value?(t(),h(C,{key:0,class:g({"opacity-25":c.value}),disabled:c.value},{default:o(()=>[r(" Cancel ")]),_:1},8,["class","disabled"])):u("",!0)]),_:1}),s(y,{onConfirmed:P},{default:o(()=>[e.value?u("",!0):(t(),h(j,{key:0,class:g({"opacity-25":c.value}),disabled:c.value},{default:o(()=>[r(" Disable ")]),_:1},8,["class","disabled"]))]),_:1})])):(t(),a("div",ye,[s(y,{onConfirmed:T},{default:o(()=>[s($,{type:"button",class:g({"opacity-25":l.value}),disabled:l.value},{default:o(()=>[r(" Enable ")]),_:1},8,["class","disabled"])]),_:1})]))])]),_:1}))}};export{je as default};
